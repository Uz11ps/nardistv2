# –í–∞—Ä–∏–∞–Ω—Ç—ã —Å–±–æ—Ä–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

–ï—Å–ª–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è —Å–±–æ—Ä–∫–∞ —á–µ—Ä–µ–∑ Docker —Å–ª–∏—à–∫–æ–º –º–µ–¥–ª–µ–Ω–Ω–∞—è, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–¥–∏–Ω –∏–∑ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã—Ö —Å–ø–æ—Å–æ–±–æ–≤:

## üöÄ –í–∞—Ä–∏–∞–Ω—Ç 1: –ë—ã—Å—Ç—Ä–∞—è —Å–±–æ—Ä–∫–∞ —Å –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏ (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)

**–°–∞–º—ã–π –±—ã—Å—Ç—Ä—ã–π —Å–ø–æ—Å–æ–±** - –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –Ω–∞–ø—Ä—è–º—É—é, –∑–∞—Ç–µ–º –ø—Ä–æ—Å—Ç–æ –∫–æ–ø–∏—Ä—É—é—Ç—Å—è –≤ Docker.

```bash
cd /opt/Nardist
git pull origin main
chmod +x scripts/build-preinstall-deps.sh
bash scripts/build-preinstall-deps.sh
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚ö° –°–∞–º—ã–π –±—ã—Å—Ç—Ä—ã–π —Å–ø–æ—Å–æ–± (2-5 –º–∏–Ω—É—Ç –≤–º–µ—Å—Ç–æ 10+ –º–∏–Ω—É—Ç)
- ‚úÖ npm —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞–ø—Ä—è–º—É—é –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (–±—ã—Å—Ç—Ä–µ–µ —á–µ–º –≤ Docker)
- ‚úÖ –ú–æ–∂–Ω–æ –≤–∏–¥–µ—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- ‚úÖ –õ–µ–≥–∫–æ –æ—Ç–ª–∞–¥–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏

## üîß –í–∞—Ä–∏–∞–Ω—Ç 2: –°–±–æ—Ä–∫–∞ —Å BuildKit

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç –∫—ç—à Docker BuildKit –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö —Å–±–æ—Ä–æ–∫.

```bash
cd /opt/Nardist
git pull origin main
chmod +x scripts/build-with-buildkit.sh
bash scripts/build-with-buildkit.sh
```

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- Docker BuildKit –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤–∫–ª—é—á–µ–Ω (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∫–ª—é—á–∞–µ—Ç—Å—è —Å–∫—Ä–∏–ø—Ç–æ–º)

## üì¶ –í–∞—Ä–∏–∞–Ω—Ç 3: –õ–æ–∫–∞–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ + –ø—Ä–æ—Å—Ç–æ–π Dockerfile

–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ª–æ–∫–∞–ª—å–Ω–æ, –∑–∞—Ç–µ–º —Å–æ–∑–¥–∞–µ—Ç –º–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π Docker –æ–±—Ä–∞–∑.

```bash
cd /opt/Nardist
git pull origin main
chmod +x scripts/build-with-local-deps.sh
bash scripts/build-with-local-deps.sh
```

## üß∂ –í–∞—Ä–∏–∞–Ω—Ç 4: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Yarn –≤–º–µ—Å—Ç–æ npm

Yarn –º–æ–∂–µ—Ç –±—ã—Ç—å –±—ã—Å—Ç—Ä–µ–µ npm –Ω–∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö.

```bash
cd /opt/Nardist
git pull origin main
chmod +x scripts/build-with-yarn.sh
bash scripts/build-with-yarn.sh
```

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- Yarn –±—É–¥–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

## üìã –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Å–ø–æ—Å–æ–± (–º–µ–¥–ª–µ–Ω–Ω—ã–π)

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π Dockerfile:

```bash
cd /opt/Nardist
git pull origin main
docker compose -f docker-compose.prod.yml build --no-cache backend
docker compose -f docker-compose.prod.yml up -d backend
```

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º

–ï—Å–ª–∏ —Å–±–æ—Ä–∫–∞ –≤—Å–µ –µ—â–µ –º–µ–¥–ª–µ–Ω–Ω–∞—è:

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∫–æ—Ä–æ—Å—Ç—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:**
   ```bash
   curl -o /dev/null -s -w "%{speed_download}\n" https://registry.npmjs.org/
   ```

2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∑–µ—Ä–∫–∞–ª–æ npm (–¥–ª—è –†–æ—Å—Å–∏–∏/–°–ù–ì):**
   ```bash
   npm config set registry https://registry.npmmirror.com/
   ```

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∏—Å–∫–∞:**
   ```bash
   df -h
   docker system df
   ```

4. **–û—á–∏—Å—Ç–∏—Ç–µ Docker –∫—ç—à:**
   ```bash
   docker system prune -af
   docker builder prune -af
   ```

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–î–ª—è –ø–µ—Ä–≤–æ–≥–æ –¥–µ–ø–ª–æ—è:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –í–∞—Ä–∏–∞–Ω—Ç 1 (build-preinstall-deps.sh)
2. **–î–ª—è –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –¥–µ–ø–ª–æ–µ–≤:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –í–∞—Ä–∏–∞–Ω—Ç 2 (BuildKit) - –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫—ç—à
3. **–ï—Å–ª–∏ npm –æ—á–µ–Ω—å –º–µ–¥–ª–µ–Ω–Ω—ã–π:** –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –í–∞—Ä–∏–∞–Ω—Ç 4 (Yarn)
